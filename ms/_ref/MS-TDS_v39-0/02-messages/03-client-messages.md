### Client Messages

Messages sent from the client to the server are as follows:

-   [Pre-Login](#Section_58886b79ec7542f3bd7be32f327366b6)

-   [Login](#Section_f159ec89ef1a4fcd9ffd8ee701fccbb0)

-   [Federated Authentication
    Token](#Section_f40cca2929b843ecb9ff2f8682486c29)

-   [SQL Batch](#Section_5b7f9062d5144b4ea7c59a27a19596c4)

-   [Bulk Load](#Section_88176081df754b24bcfb4c16ff03cbfa)

-   [Remote Procedure Call](#Section_26327437aa3c4e969bba73a6e862ba21)

-   [Attention](#Section_dc28579f49b14a789c5f63fbda002d2e)

-   [Transaction Manager
    Request](#Section_b4b7856454404fc0b5efc9e1925aaefe)

These messages are briefly described in the sections that follow.
Detailed descriptions of message contents are in section
[2.2.6](#Section_c060af9c6db74360954cc28a132c8949).

#### Pre-Login

Before a login occurs, a Pre-Login handshake occurs between client and
server, setting up contexts such as encryption and
[**MARS**](#gt_762fe1e3-0979-4402-b963-1e9150de133d)-enabled. For more
details, see section
[2.2.6.5](#Section_60f5640801884cd58b9025c6f2423868).

#### Login

When the client makes the determination to establish a TDS protocol
connection with the server side, the client sends a Login message
[**data stream**](#gt_151643ce-fb5e-460e-8bdf-dc10bbd1950e) to the
server. The client can have more than one connection to the server, but
each connection is established separately in the same way. For more
details, see section
[2.2.6.4](#Section_773a62b6ee894c029e5e344882630aac).

After the server receives the login record from the client and, if
necessary, performs subsequent authentication handshakes (such as when
SSPI [\[SSPI\]](https://go.microsoft.com/fwlink/?LinkId=90536) or
[**federated authentication**](#gt_5ae22a0e-5ff4-441b-80d4-224ef4dd4d19)
is used), the server notifies the client that it has either accepted or
rejected the connection request. For more details, see section
[3.3.5.1](#Section_8bfcbcd21baf47928fff86a63a9e90fa).

#### Federated Authentication Token

When the client indicates in the Login record that [**federated
authentication**](#gt_5ae22a0e-5ff4-441b-80d4-224ef4dd4d19)[\<4\>](\l)
is to be used but that the intended client library needs additional
information from the server to generate a federated authentication
token, if the server supports federated authentication that uses that
client library, the server responds with a token that the client uses to
perform federated authentication. The client then generates and sends a
tokenless Federated Authentication Token message that contains binary
authentication data that is generated by the federated authentication
library. For more details, see section
[2.2.6.3](#Section_827d963229574d54b9ea384530ae79d0).

After the server receives the Federated Authentication Token message
from the client, the server notifies the client that it has either
accepted or rejected the connection request. For more details, see
section 3.3.5.

#### SQL Batch

To send a [**SQL statement**](#gt_dc5ca224-43ec-4b44-9dba-726d6fd6057d)
or a batch of SQL statements, the [**SQL
batch**](#gt_1dfba466-175f-4050-a0e7-c1baf187d21d), represented by a
[**Unicode**](#gt_c305d0ab-8b94-461a-bd76-13b40cb8c4d8) string, is
copied into the data section of a TDS packet and is then sent to the
database server that supports SQL. A SQL batch can span more than one
TDS packet. For more details, see section
[2.2.6.7](#Section_f2026cd39a464a3f9a08f63140bcbbe3).

#### Bulk Load

In a [**bulk insert**](#gt_81e2b338-0f2a-4980-9824-9c27bb6d1341)/bulk
load operation, a [**SQL
statement**](#gt_dc5ca224-43ec-4b44-9dba-726d6fd6057d) consists of a
[**Unicode**](#gt_c305d0ab-8b94-461a-bd76-13b40cb8c4d8) string that is
followed by binary data. The client sends the **INSERT BULK** SQL
statement and then sends a COLMETADATA token (section
[2.2.7.4](#Section_58880b9f381c43b2bf8b0727a98c4f4c)) that describes the
raw data. Multiple rows of binary data are then sent to the server. The
data is not formatted in storage row format but in the format described
by the COLMETADATA token. The stream is the same as if the data were
being selected from the server rather than being sent to the server. For
more details, see section
[2.2.6.1](#Section_ab4a7d62cd1f4db1b67decae58f493e3).

A bulk load operation is also used for inserting data with a previously
issued **UPDATETEXT BULK** or **WRITETEXT BULK** SQL statement. For more
details, see section
[2.2.6.2](#Section_6ee5bed798d844f992177b10e2123596).

#### Remote Procedure Call

To execute a [**remote procedure call
(RPC)**](#gt_8a7f6700-8311-45bc-af10-82e10accd331) on the server, the
client sends an RPC message [**data
stream**](#gt_151643ce-fb5e-460e-8bdf-dc10bbd1950e) to the server. This
is a binary stream that contains the RPC name or numeric identifier,
options, and parameters. RPCs MUST be in a separate TDS message and not
intermixed with [**SQL
statements**](#gt_dc5ca224-43ec-4b44-9dba-726d6fd6057d). There can be
several RPCs in one message. For more details, see section
[2.2.6.6](#Section_619c43b694954a589e49a4950db245b3).

#### Attention

The client can interrupt and cancel the current request by sending an
**Attention** message. This is also known as
[**out-of-band**](#gt_26c1caf3-c889-4b99-a22b-9da056d397cf) data, but
any TDS packet that is being sent MUST be finished before sending the
**Attention** message. After the client sends an **Attention** message,
the client MUST read until it receives an **Attention** acknowledgment.

If a complete request has been sent to the server, sending a cancel
requires sending an **Attention** packet. An example of this behavior is
if the client has already sent a request, which has the last packet with
EOM bit (0x01) set in status. The **Attention** packet is the only way
to interrupt a complete request that has already been sent to the
server. For more information, see section
[4.19.2](#Section_f8aa004ebf764f94bd5b39597a888146).

If a complete request has not been sent to the server, the client MUST
send the next packet with both the ignore bit (0x02) and EOM bit (0x01)
set in the status to cancel the request. An example of this behavior is
if one or more packets have been sent but the last packet with EOM bit
(0x01) set in status has not been sent. Setting the ignore and EOM bits
terminates the current request, and the server MUST ignore the current
request. When the ignore and EOM bits are set, the server does not send
an attention acknowledgment, but instead returns a [**table
response**](#gt_71dd1dd2-c167-49a8-a5f5-6b0df5c8b48a) with a single DONE
token (section [2.2.7.6](#Section_3c06f11098bd4d5bb836b1ba66452cb7))
that has a status of DONE_ERROR to indicate that the incoming request
was ignored. For more details about the packet header status code, see
section [2.2.3.1.2](#Section_ce398f9a7d474ede8f369dd6fc21ca43).

#### Transaction Manager Request

The client can request that the connection enlist in a transaction as
described in
[\[MSDN-DTC\]](https://go.microsoft.com/fwlink/?LinkId=89994).

